<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">  
</head>
<body>
  <h1>1.22 Job Description Summarizer</h1>
  <div id="main">
    <div id="left" style="width:45%; margin:2%; float:left; border:1px solid gray">
  <form>
    <label for="job-description">Enter the job description:</label><br>
    <textarea id="job-description" name="job-description" rows="20" cols="50"></textarea><br>
    <input type="button" value="Process" onclick="process()">
  </form>
  </div>
    <div id="right" style="width:45%; margin:2%; float:left; border:1px solid gray">
  <div id="summary" style="display:none">summarized text will appear here</div>
  
  <div id="result" > AI will write here...</div>
    </div>
  </div>
  <script>
    function askai(question) {
    
        //question = $("#prompt_div").val();
        $("#result").html("AI is slow :) ... if you are patient you will be pleasantly surprised");
        $.ajax({
            url: "https://script.google.com/macros/s/AKfycbzM1DbNzmxKqygbeDTeo-6hAr8griyFjk1g1d-jpvkYZFc4RWxbmCrqnv6Z_RmzDQir/exec?AskAI="+question+"&Who=You are hiring manager",
            type: 'GET',
            complete: function() {
            },
            success: function(result) {
                $("#result").html(result);
                  
            }
        });
    }
    function summarize(){
        const promptText = document.getElementById('job-description').value;
              // Tokenize the prompt text
        const promptTokens = promptText.split(' ');

        // Remove duplicate tokens
        const uniqueTokens = [...new Set(promptTokens)];

        // Truncate the list of tokens to a specific length
        const maxTokens = 250;
        const truncatedTokens = uniqueTokens.slice(0, maxTokens);

        // Join the truncated tokens back into a single string
        const compressedPrompt = truncatedTokens.join(' ');
        
        document.getElementById('summary').textContent = compressedPrompt;
    }
    function process(){
      summarize();
      s = document.getElementById('summary').textContent;
      q = "list key skills and competencies from this in html format: ";
      askai(q+s);
      
      
    }
  </script>
</body>
</html>
